Improve random function
Don't forget to update the positions dictionary whenever it changes